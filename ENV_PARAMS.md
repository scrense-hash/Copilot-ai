# Описание параметров конфигурации Autorouter

## Основные настройки OpenRouter

### OPENROUTER_BASE_URL
- **Значение по умолчанию**: `https://openrouter.ai/api/v1`
- **Описание**: Базовый URL API OpenRouter.

### OPENROUTER_API_KEY
- **Обязательный параметр**: Да
- **Описание**: Ваш API-ключ OpenRouter.

### OPENROUTER_HTTP_REFERER
- **Значение по умолчанию**: `http://localhost`
- **Описание**: HTTP Referer для запросов OpenRouter.

### OPENROUTER_X_TITLE
- **Значение по умолчанию**: `copilot-autorouter`
- **Описание**: Название приложения для OpenRouter.

---

## Настройки прокси

### HTTP_PROXY
- **Значение по умолчанию**: Пусто
- **Описание**: HTTP прокси для запросов к API OpenRouter. Формат: `http://proxy.example.com:8080` или `http://user:pass@proxy.example.com:8080`

### HTTPS_PROXY
- **Значение по умолчанию**: Пусто
- **Описание**: HTTPS прокси для запросов к API OpenRouter (приоритетнее HTTP_PROXY). Формат: `http://proxy.example.com:8080` или `http://user:pass@proxy.example.com:8080`

**Примечание**: Если установлены оба параметра, для HTTPS запросов будет использоваться HTTPS_PROXY. Для обхода геоблокировки рекомендуется использовать HTTPS_PROXY.

---

## Настройки виртуальной модели

### VIRTUAL_MODEL_ID
- **Значение по умолчанию**: `copilot-autorouter`
- **Описание**: ID виртуальной модели.

### VIRTUAL_MODEL_NAME
- **Значение по умолчанию**: `Copilot Autorouter`
- **Описание**: Имя виртуальной модели.

---

## Правила выбора моделей

### MIN_CTX
- **Значение по умолчанию**: `131072`
- **Описание**: Минимальный размер контекста.

### MAX_PRICE
- **Значение по умолчанию**: `0.0`
- **Описание**: Максимальная цена за 1M токенов.

### PRIORITY_MODELS
- **Значение по умолчанию**: Пусто
- **Описание**: Список моделей с приоритетом (через запятую).

### BAN_MODELS
- **Значение по умолчанию**: Пусто
- **Описание**: Список моделей для исключения (через запятую).

---

## Настройки таймаутов

### REQUEST_TIMEOUT_S
- **Значение по умолчанию**: `60.0`
- **Описание**: Общий таймаут HTTP-запросов в секундах.

### STREAM_IDLE_TIMEOUT_S
- **Значение по умолчанию**: `20.0`
- **Описание**: Максимальное время без данных в потоке в секундах.

---

## Настройки стриминга

### BUFFER_STREAM_KEEPALIVE_S
- **Значение по умолчанию**: `5.0`
- **Описание**: Интервал keepalive для буферизованного стрима.

### MAX_BUFFERED_SSE_BYTES
- **Значение по умолчанию**: `20000000`
- **Описание**: Максимальный размер буфера SSE в байтах.

### STREAM_PREFORWARD_MIN_DATA
- **Значение по умолчанию**: `2`
- **Описание**: Минимальное количество SSE событий для предварительной отправки.

### STREAM_PREFORWARD_WINDOW_S
- **Значение по умолчанию**: `1.5`
- **Описание**: Временное окно в секундах для предварительной отправки SSE событий.

---

## Настройки банов

### INLINE_TOOL_BAN_TTL_S
- **Значение по умолчанию**: `21600`
- **Описание**: TTL для забаненных встроенных инструментов в секундах (6 часов).

### EARLY_EOF_BAN_TTL_S
- **Значение по умолчанию**: `900`
- **Описание**: TTL для банов при досрочном EOF в секундах (15 минут).

---

## Настройки кэша моделей

### REFRESH_MODELS_S
- **Значение по умолчанию**: `300`
- **Описание**: Частота обновления списка моделей в секундах.

---

## Настройки логирования

### LOG_LEVEL
- **Значение по умолчанию**: `INFO`
- **Описание**: Уровень логирования (DEBUG, INFO, WARNING, ERROR).

### LOG_PATH
- **Значение по умолчанию**: `/var/log/autorouter/autorouter.log`
- **Описание**: Путь к файлу логов.

### DEBUG_SSE_TRAFFIC
- **Значение по умолчанию**: `false`
- **Описание**: Включить подробное логирование SSE трафика.

### DEBUG_SSE_TRAFFIC_LOG_PATH
- **Значение по умолчанию**: `traffic_sse.log`
- **Описание**: Путь к файлу логов SSE.

### DEBUG_SSE_TRAFFIC_TRUNCATE_BYTES
- **Значение по умолчанию**: `0`
- **Описание**: Размер обрезки сообщений логирования SSE.

### DEBUG_SSE_TRAFFIC_MAX_BYTES
- **Значение по умолчанию**: `100000000`
- **Описание**: Максимальный размер файла лога SSE.

### DEBUG_SSE_TRAFFIC_BACKUP_COUNT
- **Значение по умолчанию**: `3`
- **Описание**: Количество резервных файлов лога SSE.

### DEBUG_SSE_TRAFFIC_MIRROR_MAIN
- **Значение по умолчанию**: `True`
- **Описание**: Зеркалировать часть трафика в основной лог.

### DEBUG_SSE_TRAFFIC_MIRROR_MAIN_MAX_CHUNKS
- **Значение по умолчанию**: `5`
- **Описание**: Макс. кол-во чанков трафика для зеркалирования в основном логе.

---

## Прочие настройки

### USER_AGENT
- **Значение по умолчанию**: `copilot-autorouter/0.8.0 (+https://openrouter.ai)`
- **Описание**: User-Agent для запросов.

### MAX_REQUEST_BYTES
- **Значение по умолчанию**: `2000000`
- **Описание**: Максимальный размер тела запроса в байтах.

### PORT
- **Значение по умолчанию**: `8000`
- **Описание**: Порт, на котором работает сервис.

### ATTEMPT_DEADLINE_NONSTREAM_S
- **Значение по умолчанию**: `20.0`
- **Описание**: Предельное время попытки нестримингового запроса в секундах.

---